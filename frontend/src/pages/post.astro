    ---
    import fs from 'fs';
    import path from 'path';

    // Windowsã§æ—¢ã«å‹•ã„ãŸã®ã¨åŒã˜è¦é ˜ã§ç›¸å¯¾ãƒ‘ã‚¹èª¿æ•´
    const histPath = path.resolve("../backend/history.json");
    let history = {};
    try {
    history = JSON.parse(fs.readFileSync(histPath, "utf-8"));
    } catch (e) {
    history = {};
    }

    const dates = Object.keys(history).sort().reverse(); // æ–°ã—ã„æ—¥ä»˜ãŒå…ˆ
    ---

    <html lang="ja">
    <head>
        <meta charset="utf-8" />
        <title>éå»ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹</title>
        <style>
        body { font-family: system-ui, sans-serif; margin: 24px; }
        header { display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; }
        .controls { display:flex; gap:8px; align-items:center; }
        input, select, button { padding:8px; font-size:14px; }
        .date-section { margin: 24px 0; }
        .date-title { margin: 0 0 8px; font-size:18px; }
        .item { padding:8px 0; border-bottom:1px solid #eee; }
        a { color:#0366d6; text-decoration:none; }
        a:hover { text-decoration:underline; }
        .empty { color:#666; }
        </style>
    </head>
    <body>
        <header>
        <h1>ğŸ“š éå»ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹</h1>
        <nav><a href="/">â† ãƒˆãƒƒãƒ—</a></nav>
        </header>

        <div class="controls">
        <label>æ—¥ä»˜:
            <select id="dateSelect">
            <option value="">ã™ã¹ã¦</option>
            {dates.map(d => <option value={d}>{d}</option>)}
            </select>
        </label>
        <label>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:
            <input id="keyword" type="text" placeholder="ã‚¿ã‚¤ãƒˆãƒ«ã«å«ã¾ã‚Œã‚‹èªã§æ¤œç´¢" />
        </label>
        <button id="clear">æ¡ä»¶ã‚¯ãƒªã‚¢</button>
        </div>

        <div id="results"></div>

        <script is:inline>
        const historyData = JSON.parse({JSON.stringify(history)});
        const results = document.getElementById('results');
        const dateSel = document.getElementById('dateSelect');
        const kwInput = document.getElementById('keyword');
        const clearBtn = document.getElementById('clear');

        function render() {
            const date = dateSel.value;
            const kw = (kwInput.value || '').toLowerCase().trim();

            // å¯¾è±¡æ—¥ä»˜ã®ã‚­ãƒ¼ã‚’æ±ºã‚ã‚‹
            const keys = date ? [date] : Object.keys(historyData).sort().reverse();

            let html = '';
            let total = 0;

            for (const d of keys) {
            const items = (historyData[d] || []);
            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ãƒ•ã‚£ãƒ«ã‚¿
            const filtered = kw ? items.filter(x => (x.title || '').toLowerCase().includes(kw)) : items;

            if (!filtered.length) continue;
            total += filtered.length;

            html += `<section class="date-section">
                <h2 class="date-title">ğŸ—“ ${d}ï¼ˆ${filtered.length}ä»¶ï¼‰</h2>
                <ul style="list-style:none; padding:0; margin:0;">` +
                filtered.map(x => `
                <li class="item">
                    <a href="${x.link}" target="_blank" rel="noopener noreferrer">${x.title}</a>
                </li>
                `).join('') +
                `</ul>
            </section>`;
            }

            if (!total) {
            html = '<p class="empty">æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
            }
            results.innerHTML = html;
        }

        dateSel.addEventListener('change', render);
        kwInput.addEventListener('input', render);
        clearBtn.addEventListener('click', () => {
            dateSel.value = '';
            kwInput.value = '';
            render();
        });

        render();
        </script>
    </body>
    </html>
